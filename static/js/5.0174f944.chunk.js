(this.webpackJsonpbike=this.webpackJsonpbike||[]).push([[5],{125:function(t,e,n){"use strict";n.d(e,"d",(function(){return O})),n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return g})),n.d(e,"c",(function(){return x}));var a=n(121),o=n.n(a),c=n(122),i=n(30),r=n(1),s=n(133),u=n.n(s),l=n(142),b=function(){var t=(new Date).toGMTString(),e=new l.a("SHA-1","TEXT");return e.setHMACKey("W3Xh3Nu_xQlCw7EY5CctQegleQ0","TEXT"),e.update("x-date: "+t),{Authorization:'hmac username="8d1f8b7eeb79421ba1ed2914848b717d", algorithm="hmac-sha1", headers="x-date", signature="'+e.getHMAC("B64")+'"',"X-Date":t}},j=u.a.create({headers:b(),baseURL:"https://ptx.transportdata.tw/MOTC/v2/Bike/"}),d=u.a.create({headers:b(),baseURL:"https://ptx.transportdata.tw/MOTC/v2/Cycling/Shape"}),p=n(70),f=function(t){var e=Object(p.a)();return{successToast:function(n){if(!e.isActive(t))return e({id:t,title:n,position:"bottom",status:"success",duration:3e3,isClosable:!0})},warningToast:function(n){if(!e.isActive(t))return e({id:t,title:n,position:"bottom",status:"warning",duration:3e3,isClosable:!0})},infoToast:function(n){if(!e.isActive(t))return e({id:t,title:n,position:"bottom",status:"error",duration:3e3,isClosable:!0})},errorToast:function(n){if(!e.isActive(t))return e({id:t,title:n,position:"bottom",status:"error",duration:3e3,isClosable:!0})}}},O=function(){var t=Object(r.useState)([]),e=Object(i.a)(t,2),n=e[0],a=e[1],s=f("error").errorToast,u=function(){var t=Object(c.a)(o.a.mark((function t(e){var n,c,i,r,u,l,b;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.option,c=e.city,i=e.lat,r=e.lng,u="nearby"===n?"Station/NearBy?$top=30&$spatialFilter=nearby(".concat(i,", ").concat(r,", 1000)&$format=JSON"):"Station/".concat(c,"?$top=30&$format=JSON"),t.prev=2,t.next=5,j.get(u);case 5:l=t.sent,b=l.data,a(b),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),s("\u6b0a\u9650\u5230\u671f\uff0c\u8acb\u91cd\u65b0\u6574\u7406\u5f8c\u518d\u8a66\u4e00\u6b21");case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}();return[n,u]},h=function(){var t=Object(r.useState)([]),e=Object(i.a)(t,2),n=e[0],a=e[1],s=function(){var t=Object(c.a)(o.a.mark((function t(e){var n,c,i,r,s,u,l;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.option,c=e.city,i=e.lat,r=e.lng,s="nearby"===n?"Availability/NearBy?$top=30&$spatialFilter=nearby(".concat(i,", ").concat(r,", 1000)&$format=JSON"):"Availability/".concat(c,"?$top=30&$format=JSON"),t.prev=2,t.next=5,j.get(s);case 5:u=t.sent,l=u.data,a(l),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}();return[n,s]},g=function(){var t=Object(r.useState)(null),e=Object(i.a)(t,2),n=e[0],a=e[1],o=Object(r.useState)(null),c=Object(i.a)(o,2),s=c[0],u=c[1],l=Object(r.useState)(null),b=Object(i.a)(l,2),j=b[0],d=b[1],p=function(t){var e=t.coords;a(e.latitude),u(e.longitude)},f=function(t){d(t.message)};return Object(r.useEffect)((function(){var t=navigator.geolocation,e=t.watchPosition(p,f);if(t)return function(){return t.clearWatch(e)};d("Geolocation is not supported")}),[]),[n,s,j]},x=function(){var t=Object(r.useState)([]),e=Object(i.a)(t,2),n=e[0],a=e[1],s=f("error").errorToast,u=function(){var t=Object(c.a)(o.a.mark((function t(e){var n,c,i,r,u,l;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.city,c=e.skip,i=c?"$skip=".concat(c):"","$top=30&$format=JSON",r="".concat(n,"?").concat(i,"&").concat("$top=30&$format=JSON"),t.prev=4,t.next=7,d.get(r);case 7:u=t.sent,l=u.data,a(l),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(4),s("\u6b0a\u9650\u5230\u671f\uff0c\u8acb\u91cd\u65b0\u6574\u7406\u5f8c\u518d\u8a66\u4e00\u6b21");case 15:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(e){return t.apply(this,arguments)}}();return[n,u]}},126:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var a=n(30),o=n(62),c=n(1),i=n.p+"static/media/marker2.509bc30b.svg",r=n.p+"static/media/flag.a2df00b5.svg",s=n.p+"static/media/crosshair.a8fe395c.svg",u=n(129),l=n(127),b=n(6),j={width:"100%",height:"100%"},d=function(t){var e=t.lat,n=t.lng,d=t.nearbySpots,p=t.routePath,f=Object(c.useState)(null),O=Object(a.a)(f,2),h=O[0],g=O[1],x=Object(c.useState)(null),m=Object(a.a)(x,2),v=m[0],y=m[1],w=Object(u.e)({id:"google-map-script",googleMapsApiKey:"AIzaSyDt-oZ5eKw7KUb_zG0At9Hlq82SvW_q6ZY"}).isLoaded,C=Object(c.useState)(null),S=Object(a.a)(C,2),k=S[0],T=S[1];Object(c.useEffect)((function(){p&&T(p.Geometry.replace(/[A-Z'()']{1}/gm,"").trim().split(",").reduce((function(t,e){var n=e.split(" ");return[].concat(Object(l.a)(t),[{lat:1*n[1],lng:1*n[0]}])}),[]))}),[p]),Object(c.useEffect)((function(){k&&h.panTo(k[0])}),[k]);var N;return w&&e?Object(b.jsx)(o.c,{flex:1,w:"100%",overflow:"hidden",children:Object(b.jsxs)(u.a,{mapContainerStyle:j,zoom:15,onLoad:function(t){g(t),t.setCenter({lat:e,lng:n})},children:[d.length>0&&(N=d,N.length>0&&N.map((function(t){return Object(b.jsx)("div",{children:Object(b.jsx)(u.c,{position:{lat:t.StationPosition.PositionLat,lng:t.StationPosition.PositionLon},onClick:function(){y(t)},options:{icon:{url:i}}})},t.StationID)}))),v&&Object(b.jsx)(u.b,{position:{lat:v.StationPosition.PositionLat,lng:v.StationPosition.PositionLon},onCloseClick:function(t){y(null)},onLoad:function(){return console.log(123)},children:Object(b.jsxs)(o.c,{flexDirection:"column",bg:"brand.white",borderRadius:"6px",boxShadow:"xl",p:3,maxW:"300px",gridGap:1,children:[Object(b.jsx)(o.f,{fontWeight:"700",children:v.StationName.Zh_tw}),Object(b.jsxs)(o.f,{children:["\u5269\u9918\u8eca\u8f1b: ",v.AvailableRentBikes]}),Object(b.jsxs)(o.f,{children:["\u76ee\u524d\u7a7a\u4f4d: ",v.AvailableReturnBikes]})]})}),Object(b.jsx)(u.d,{onLoad:function(t){console.log("polyline: ",t)},path:k,options:{strokeColor:"#000000",strokeOpacity:.6,strokeWeight:5,fillColor:"#000000",fillOpacity:.35,clickable:!1,draggable:!1,editable:!1,visible:!0,radius:3e4,zIndex:1}}),k&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(u.c,{position:{lat:k[0].lat,lng:k[0].lng},options:{icon:{url:s}}}),Object(b.jsx)(u.c,{position:{lat:k[k.length-1].lat,lng:k[k.length-1].lng},options:{icon:{url:r}}})]})]})}):Object(b.jsx)(b.Fragment,{})},p=Object(c.memo)(d)},128:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var a=n(62),o=n(64),c=n(8),i=n(143),r=n(44),s=n(6),u=function(t){var e=t.onHamburgerClick,n=t.children,u=t.routeName,l=Object(c.g)();return Object(s.jsxs)(a.c,{position:"sticky",zIndex:"sticky",top:"0",bg:"brand.yellow",boxShadow:"sm",w:"100%",alignItems:"center",py:5,px:10,color:"white",gridGap:"5rem",minH:"80px",children:[Object(s.jsx)(a.c,{alignSelf:"center",cursor:"pointer",onClick:function(){return l("/")},display:{base:"none",md:"block"},children:Object(s.jsx)(r.a,{})}),u&&Object(s.jsx)(a.e,{size:"sm",color:"black",m:"auto",children:u}),n,Object(s.jsx)(o.a,{variant:"default",marginLeft:"auto",boxShadow:"none",w:"40px",h:"40px",onClick:e,onFocus:function(){return document.activeElement.blur()},size:"sm",children:Object(s.jsx)(i.a,{w:5,h:5})})]})}},170:function(t,e,n){"use strict";n.r(e);var a=n(127),o=n(30),c=n(11),i=n(74),r=n(62),s=n(64),u=new Map([["\u8acb\u9078\u64c7\u57ce\u5e02",""],["\u53f0\u5317\u5e02","Taipei"],["\u65b0\u5317\u5e02","NewTaipei"],["\u6843\u5712\u5e02","Taoyuan"],["\u53f0\u4e2d\u5e02","Taichung"],["\u53f0\u5357\u5e02","Tainan"],["\u9ad8\u96c4\u5e02","Kaohsiung"],["\u57fa\u9686\u5e02","Keelung"],["\u65b0\u7af9\u7e23","HsinchuCounty"],["\u5f70\u5316\u7e23","ChanghuaCounty"],["\u5357\u6295\u7e23","NantouCounty"],["\u96f2\u6797\u7e23","YunlinCounty"],["\u5609\u7fa9\u7e23","ChiayiCounty"],["\u5609\u7fa9\u5e02","Chiayi"],["\u5c4f\u6771\u7e23","PingtungCounty"],["\u5b9c\u862d\u7e23","YilanCounty"],["\u82b1\u84ee\u7e23","HualienCounty"],["\u53f0\u6771\u7e23","TaitungCounty"],["\u91d1\u9580\u7e23","KinmenCounty"],["\u6f8e\u6e56\u7e23","PenghuCounty"],["\u82d7\u6817\u7e23","MiaoliCounty"]]),l=n(128),b=n(1),j=n(125),d=n(6),p=n(66),f=n(31),O=n(166),h={whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",maxW:"100px"},g=function(t){var e=t.spot,n=t.onClick,a=Object(b.useState)(),c=Object(o.a)(a,2),i=c[0],s=c[1];return Object(d.jsx)(r.a,{ratio:2.5,children:Object(d.jsxs)(r.c,{cursor:"pointer",borderRadius:"10px",overflow:"hidden",flexDirection:"column",justifyContent:"space-between !important",boxShadow:"lg",marginBottom:"40px",bg:i?"brand.black":"white",color:i?"brand.yellow":"brand.black",transition:"all 0.5s ease",p:2,onClick:n,onMouseEnter:function(){return s(!0)},onMouseLeave:function(){return s(!1)},children:[Object(d.jsx)(r.e,Object(p.a)(Object(p.a)({w:"100%"},h),{},{maxW:"100%",color:"brand.grey",textAlign:"start",size:{base:"sm",sm:"md"},children:e.RouteName})),Object(d.jsxs)(r.c,{justifyContent:"space-between",w:"100%",fontSize:"12px",children:[Object(d.jsxs)(r.c,{children:[Object(d.jsx)(r.f,{children:e.Direction}),Object(d.jsxs)(r.f,{children:[(e.CyclingLength/1e3).toFixed(2),"\u516c\u91cc"]})]}),Object(d.jsxs)(r.c,{children:[Object(d.jsx)(f.a,{as:O.a,alignSelf:"center"}),Object(d.jsxs)(r.f,Object(p.a)(Object(p.a)({},h),{},{children:[e.City,"\xa0",e.Town]}))]})]})]})},e.RouteName)},x=n(67),m=n(126);e.default=function(){var t=Object(j.b)(),e=Object(o.a)(t,2),n=e[0],p=e[1],f=Object(c.c)(),O=f.isOpen,h=f.onOpen,v=f.onClose,y=Object(b.useState)(""),w=Object(o.a)(y,2),C=w[0],S=w[1],k=Object(j.c)(),T=Object(o.a)(k,2),N=T[0],A=T[1],$=Object(b.useState)([]),L=Object(o.a)($,2),P=L[0],E=L[1],R=Object(b.useState)(0),z=Object(o.a)(R,2),D=z[0],M=z[1],H=Object(b.useState)(null),J=Object(o.a)(H,2),W=J[0],B=J[1],F=Object(b.useState)(!0),G=Object(o.a)(F,2),K=G[0],I=G[1];Object(b.useEffect)((function(){""!==C&&(M(0),E([]),A({city:C,skip:0}))}),[C]),Object(b.useEffect)((function(){I(!(0===N.length)),E([].concat(Object(a.a)(P),Object(a.a)(N)))}),[N]),Object(b.useEffect)((function(){""!==C&&A({city:C,skip:D})}),[D]),Object(b.useEffect)((function(){console.log(W)}),[W]);var Y;return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)(x.a,{onDrawerOpen:O,onDrawerClose:v,children:[Object(d.jsx)(i.a,{bg:"brand.black",w:"150px",color:"brand.white",borderRadius:"100px",onChange:function(t){return S(t.currentTarget.value)},value:C,children:Object(a.a)(u).map((function(t){return Object(d.jsx)("option",{value:t[1],style:{backgroundColor:"black"},children:t[0]},t[1])}))}),Object(d.jsx)(r.d,{p:5,w:"100%",borderRadius:"16px",bg:"brand.yellow",h:"70vh",overflowY:"scroll",templateColumns:{base:"repeat(1, 1fr)"},gridGap:5,children:P.length>0?(Y=P,Y.map((function(t){return Object(d.jsx)(g,{spot:t,onClick:function(){v(),B(t)}},t.RouteName)}))):Object(d.jsx)(r.c,{py:5,children:"\u8acb\u9078\u64c7\u57ce\u5e02"})}),Object(d.jsx)(s.a,{variant:"default",disabled:!K,onClick:function(){return M(D+30)},children:K?"\u8f09\u5165\u66f4\u591a":"\u5df2\u5230\u5e95\u90e8"})]}),Object(d.jsxs)(r.c,{flexDirection:"column",h:"100vh",alignItems:"center",children:[Object(d.jsx)(l.a,{onHamburgerClick:h,routeName:W&&W.RouteName||"\u8acb\u9078\u64c7\u8eca\u9053"}),n&&Object(d.jsx)(m.a,{lat:n,lng:p,nearbySpots:[],routePath:W})]})]})}}}]);
//# sourceMappingURL=5.0174f944.chunk.js.map